<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Standardized mean differences for fitted `lme` and `gls` models • lmeInfo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Standardized mean differences for fitted `lme` and `gls` models">
<meta property="og:description" content="lmeInfo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lmeInfo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Information-matrices-for-fitted-LME-models.html">Information matrices for fitted `lme()` and `gls()` models</a>
    </li>
    <li>
      <a href="../articles/Standardized-mean-differences-in-multi-level-models.html">Standardized mean differences for fitted `lme` and `gls` models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jepusto/lmeInfo" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Standardized mean differences for fitted <code>lme</code> and <code>gls</code> models</h1>
            
            <h4 data-toc-skip class="date">2022-10-10</h4>
      
      
      <div class="hidden name"><code>Standardized-mean-differences-in-multi-level-models.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="standardized-mean-difference-effect-sizes-in-linear-mixed-effects-models">Standardized mean difference effect sizes in linear mixed effects models<a class="anchor" aria-label="anchor" href="#standardized-mean-difference-effect-sizes-in-linear-mixed-effects-models"></a>
</h2>
<p>The <code>lmeInfo</code> package includes a function, <code><a href="../reference/g_mlm.html">g_mlm()</a></code>, for estimating a standardized mean difference effect size from a multi-level model fitted using <code><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme()</a></code> or <code><a href="https://rdrr.io/pkg/nlme/man/gls.html" class="external-link">gls()</a></code> from the <code>nlme</code> package. The estimation methods follow Pustejovsky, Hedges, and Shadish (2014). Let <span class="math inline">\(\boldsymbol{\beta}\)</span> denote the fixed effect parameters and <span class="math inline">\(\boldsymbol{\theta}\)</span> denote the variance components (in the natural, variance-covariance parameterization) from a multi-level model. A standardized mean difference effect size can then be defined as <span class="math display">\[
\delta = \frac{\mathbf{p}'\boldsymbol\beta}{\sqrt{\mathbf{r}'\boldsymbol\theta}},
\]</span> for some fixed vectors <span class="math inline">\(\mathbf{p}\)</span> and <span class="math inline">\(\mathbf{r}\)</span>.</p>
<p>The <code><a href="../reference/g_mlm.html">g_mlm()</a></code> function takes as inputs a fitted <code><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme()</a></code> model and the vectors <span class="math inline">\(\mathbf{p}\)</span> and <span class="math inline">\(\mathbf{r}\)</span>. It computes an estimate of <span class="math inline">\(\delta\)</span> as <span class="math display">\[
d = \left(1 - \frac{3}{4 \nu - 1}\right) \frac{\mathbf{p}'\boldsymbol{\hat\beta}}{\sqrt{\mathbf{r}'\boldsymbol{\hat\theta}}},
\]</span> where <span class="math inline">\(\boldsymbol{\hat\beta}\)</span> and <span class="math inline">\(\boldsymbol{\hat\theta}\)</span> are maximum likelihood or restricted maximum likelihood estimates of the fixed effects and variance components, respectively. Here, <span class="math inline">\(\nu\)</span> is the Satterthwaite degrees of freedom given by <span class="math display">\[
\nu = \frac{2 \left(\mathbf{r}'\boldsymbol{\hat\theta}\right)^2}{\text{Var}\left(\mathbf{r}'\boldsymbol{\hat\theta}\right)},
\]</span> and the variance of <span class="math inline">\(\mathbf{r}'\boldsymbol{\hat\theta}\)</span> is calculated using the inverse of the Fisher information matrix. An approximate standard error for the standardized mean difference estimate is <span class="math display">\[
\text{SE}(d) \approx \left(1 - \frac{3}{4 \nu - 1}\right) \sqrt{\frac{\nu}{\nu - 2} \times \frac{\text{Var}\left(\mathbf{p}'\boldsymbol{\hat\beta}\right)}{\mathbf{r}'\boldsymbol{\hat\theta}} + d^2 \times \frac{8 \nu^2 - \nu + 2}{16 (\nu - 2) (\nu - 1)^2}}
\]</span> (Pustejovsky, Hedges, &amp; Shadish, 2014).</p>
</div>
<div class="section level2">
<h2 id="demonstration">Demonstration<a class="anchor" aria-label="anchor" href="#demonstration"></a>
</h2>
<p>We use a dataset from a multiple baseline study conducted by Bryant and colleagues (2016) to demonstrate how to calculate a design-comparable standardized mean difference effect size based on the fitted model.</p>
<p>The study by Bryant and colleagues (2016) involved collecting repeated measures of math performance on multiple students, in each of several classrooms. After an initial baseline period in each classroom, an intervention was introduced and its effects on student math performance were observed over time. For sake of illustration, we use a very simple model for these data, consisting of a simple change in levels coinciding with the introduction of treatment. We include random effects for each classroom and each student. Here we fit the model using <code><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">nlme::lme()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jepusto.github.io/lmeInfo/">lmeInfo</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Bryant2016</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Bryant2016_RML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span>fixed <span class="op">=</span> <span class="va">outcome</span> <span class="op">~</span> <span class="va">treatment</span>,</span>
<span>                      random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">school</span><span class="op">/</span><span class="va">case</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">Bryant2016</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Bryant2016_RML</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed-effects model fit by REML</span></span>
<span><span class="co">##   Data: Bryant2016 </span></span>
<span><span class="co">##        AIC      BIC    logLik</span></span>
<span><span class="co">##   2627.572 2646.041 -1308.786</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Formula: ~1 | school</span></span>
<span><span class="co">##         (Intercept)</span></span>
<span><span class="co">## StdDev:    12.57935</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Formula: ~1 | case %in% school</span></span>
<span><span class="co">##         (Intercept) Residual</span></span>
<span><span class="co">## StdDev:    15.98217   18.398</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:  outcome ~ treatment </span></span>
<span><span class="co">##                       Value Std.Error  DF   t-value p-value</span></span>
<span><span class="co">## (Intercept)        56.14333  9.019268 286  6.224821       0</span></span>
<span><span class="co">## treatmenttreatment 49.33454  2.399065 286 20.564070       0</span></span>
<span><span class="co">##  Correlation: </span></span>
<span><span class="co">##                    (Intr)</span></span>
<span><span class="co">## treatmenttreatment -0.194</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Standardized Within-Group Residuals:</span></span>
<span><span class="co">##         Min          Q1         Med          Q3         Max </span></span>
<span><span class="co">## -3.15430670 -0.65412204  0.02112957  0.61701090  2.90624593 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Observations: 299</span></span>
<span><span class="co">## Number of Groups: </span></span>
<span><span class="co">##           school case %in% school </span></span>
<span><span class="co">##                3               12</span></span></code></pre>
<p>The estimated variance components from the fitted model can be obtained using <code><a href="../reference/extract_varcomp.html">extract_varcomp()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_varcomp.html">extract_varcomp</a></span><span class="op">(</span><span class="va">Bryant2016_RML</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $Tau</span></span>
<span><span class="co">## $Tau$case</span></span>
<span><span class="co">## case.var((Intercept)) </span></span>
<span><span class="co">##              255.4297 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Tau$school</span></span>
<span><span class="co">## school.var((Intercept)) </span></span>
<span><span class="co">##                  158.24 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $cor_params</span></span>
<span><span class="co">## numeric(0)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $var_params</span></span>
<span><span class="co">## numeric(0)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $sigma_sq</span></span>
<span><span class="co">## [1] 338.4864</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "varcomp"</span></span></code></pre>
<p>In our model for the Bryant data, we use the treatment effect in the numerator of the effect size and the sum of the classroom-level, student-level, and within-student variance components in the denominator of the effect size. The constants are therefore given by <span class="math inline">\(\mathbf{p} = (0, 1)'\)</span> and <span class="math inline">\(\mathbf{r} = (1, 1, 1)'\)</span>. The effect size estimate can be calculated as:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Bryant2016_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/g_mlm.html">g_mlm</a></span><span class="op">(</span><span class="va">Bryant2016_RML</span>, p_const <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, r_const <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, infotype <span class="op">=</span> <span class="st">"expected"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Bryant2016_g</span></span></code></pre></div>
<pre><code><span><span class="co">##                           est    se</span></span>
<span><span class="co">## unadjusted effect size  1.799 0.340</span></span>
<span><span class="co">## adjusted effect size    1.721 0.325</span></span>
<span><span class="co">## degree of freedom      17.504</span></span></code></pre>
<p>A <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method is also included, which includes more detail about the model parameter estimates and effect size estimate:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Bryant2016_g</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                            est      se</span></span>
<span><span class="co">## Tau.case.case.var((Intercept))         255.430 126.671</span></span>
<span><span class="co">## Tau.school.school.var((Intercept))     158.240 238.653</span></span>
<span><span class="co">## sigma_sq                               338.486  28.306</span></span>
<span><span class="co">## total variance                         752.156 254.250</span></span>
<span><span class="co">## (Intercept)                             56.143   9.019</span></span>
<span><span class="co">## treatmenttreatment                      49.335   2.399</span></span>
<span><span class="co">## treatment effect at a specified time    49.335   2.399</span></span>
<span><span class="co">## unadjusted effect size                   1.799   0.340</span></span>
<span><span class="co">## adjusted effect size                     1.721   0.325</span></span>
<span><span class="co">## degree of freedom                       17.504        </span></span>
<span><span class="co">## constant kappa                           0.087        </span></span>
<span><span class="co">## logLik                               -1308.786</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Bryant, B. R., Bryant, D. P., Porterfield, J., Dennis, M. S., Falcomata, T., Valentine, C., … &amp; Bell, K. (2016). The effects of a Tier 3 intervention on the mathematics performance of second grade students with severe mathematics difficulties. <em>Journal of Learning Disabilities, 49</em>(2), 176-188. <a href="doi:10.1177/0022219414538516" class="uri">doi:10.1177/0022219414538516</a></p>
<p>Pustejovsky, J. E., Hedges, L. V., &amp; Shadish, W. R. (2014). Design-comparable effect sizes in multiple baseline designs: A general modeling framework. <em>Journal of Educational and Behavioral Statistics, 39</em>(5), 368–393. <a href="doi:10.3102/1076998614547577" class="uri">doi:10.3102/1076998614547577</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.jepusto.com/" class="external-link">James Pustejovsky</a>, Man Chen.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'ab49bdeb500af0e2e09f15c826d29f1f',
    indexName: 'lmeInfo',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
