<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Standardized mean differences for fitted `lme` and `gls` models • lmeInfo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Standardized mean differences for fitted `lme` and `gls` models">
<meta property="og:description" content="lmeInfo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lmeInfo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Information-matrices-for-fitted-LME-models.html">Information matrices for fitted `lme()` and `gls()` models</a>
    </li>
    <li>
      <a href="../articles/Standardized-mean-differences-in-multi-level-models.html">Standardized mean differences for fitted `lme` and `gls` models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jepusto/lmeInfo">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Standardized mean differences for fitted <code>lme</code> and <code>gls</code> models</h1>
            
            <h4 class="date">2020-04-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jepusto/lmeInfo/blob/master/vignettes/Standardized-mean-differences-in-multi-level-models.Rmd"><code>vignettes/Standardized-mean-differences-in-multi-level-models.Rmd</code></a></small>
      <div class="hidden name"><code>Standardized-mean-differences-in-multi-level-models.Rmd</code></div>

    </div>

    
    
<div id="standardized-mean-difference-effect-sizes-in-linear-mixed-effects-models" class="section level1">
<h1 class="hasAnchor">
<a href="#standardized-mean-difference-effect-sizes-in-linear-mixed-effects-models" class="anchor"></a>Standardized mean difference effect sizes in linear mixed effects models</h1>
<p>The <code>lmeInfo</code> package includes a function, <code><a href="../reference/g_mlm.html">g_mlm()</a></code>, for estimating a standardized mean difference effect size from a multi-level model fitted using <code><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme()</a></code> or <code><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls()</a></code> from the <code>nlme</code> package. The estimation methods follow Pustejovsky, Hedges, and Shadish (2014). Let <span class="math inline">\(\boldsymbol{\beta}\)</span> denote the fixed effect parameters and <span class="math inline">\(\boldsymbol{\theta}\)</span> denote the variance components (in the natural, variance-covariance parameterization) from a multi-level model. A standardized mean difference effect size can then be defined as <span class="math display">\[
\delta = \frac{\mathbf{p}'\boldsymbol\beta}{\sqrt{\mathbf{r}'\boldsymbol\theta}},
\]</span> for some fixed vectors <span class="math inline">\(\mathbf{p}\)</span> and <span class="math inline">\(\mathbf{r}\)</span>.</p>
<p>The <code><a href="../reference/g_mlm.html">g_mlm()</a></code> function takes as inputs a fitted <code><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme()</a></code> model and the vectors <span class="math inline">\(\mathbf{p}\)</span> and <span class="math inline">\(\mathbf{r}\)</span>. It computes an estimate of <span class="math inline">\(\delta\)</span> as <span class="math display">\[
d = \left(1 - \frac{3}{4 \nu - 1}\right) \frac{\mathbf{p}'\boldsymbol{\hat\beta}}{\sqrt{\mathbf{r}'\boldsymbol{\hat\theta}}},
\]</span> where <span class="math inline">\(\boldsymbol{\hat\beta}\)</span> and <span class="math inline">\(\boldsymbol{\hat\theta}\)</span> are maximum likelihood or restricted maximum likelihood estimates of the fixed effects and variance components, respectively. Here, <span class="math inline">\(\nu\)</span> is the Satterthwaite degrees of freedom given by <span class="math display">\[
\nu = \frac{2 \left(\mathbf{r}'\boldsymbol{\hat\theta}\right)^2}{\text{Var}\left(\mathbf{r}'\boldsymbol{\hat\theta}\right)},
\]</span> and the variance of <span class="math inline">\(\mathbf{r}'\boldsymbol{\hat\theta}\)</span> is calculated using the inverse of the Fisher information matrix. An approximate standard error for the standardized mean difference estimate is <span class="math display">\[
\text{SE}(d) \approx \sqrt{\frac{\text{Var}\left(\mathbf{p}'\boldsymbol{\hat\beta}\right)}{\mathbf{r}'\boldsymbol{\hat\theta}} + \frac{d^2}{2 \nu}}
\]</span> (Pustejovsky, Hedges, &amp; Shadish, 2014).</p>
</div>
<div id="demonstration" class="section level1">
<h1 class="hasAnchor">
<a href="#demonstration" class="anchor"></a>Demonstration</h1>
<p>We use a dataset from a multiple baseline study conducted by Bryant and colleagues (2016) to demonstrate how to calculate a design-comparable standardized mean difference effect size based on the fitted model.</p>
<p>The study by Bryant and colleagues (2016) involved collecting repeated measures of math performance on multiple students, in each of several classrooms. After an initial baseline period in each classroom, an intervention was introduced and its effects on student math performance were observed over time. For sake of illustration, we use a very simple model for these data, consisting of a simple change in levels coinciding with the introduction of treatment. We include random effects for each classroom and each student. Here we fit the model using <code><a href="https://rdrr.io/pkg/nlme/man/lme.html">nlme::lme()</a></code>:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lmeInfo</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">nlme</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">Bryant2016</span>)

<span class="no">Bryant2016_RML</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span>(<span class="kw">fixed</span> <span class="kw">=</span> <span class="no">outcome</span> ~ <span class="no">treatment</span>,
                      <span class="kw">random</span> <span class="kw">=</span> ~ <span class="fl">1</span> <span class="kw">|</span> <span class="no">school</span>/<span class="no">case</span>,
                      <span class="kw">data</span> <span class="kw">=</span> <span class="no">Bryant2016</span>)

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">Bryant2016_RML</span>)</pre></body></html></div>
<pre><code>## Linear mixed-effects model fit by REML
##  Data: Bryant2016 
##        AIC      BIC    logLik
##   2627.572 2646.041 -1308.786
## 
## Random effects:
##  Formula: ~1 | school
##         (Intercept)
## StdDev:    12.57935
## 
##  Formula: ~1 | case %in% school
##         (Intercept) Residual
## StdDev:    15.98217   18.398
## 
## Fixed effects: outcome ~ treatment 
##                       Value Std.Error  DF   t-value p-value
## (Intercept)        56.14333  9.019268 286  6.224821       0
## treatmenttreatment 49.33454  2.399065 286 20.564070       0
##  Correlation: 
##                    (Intr)
## treatmenttreatment -0.194
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -3.15430670 -0.65412204  0.02112957  0.61701090  2.90624593 
## 
## Number of Observations: 299
## Number of Groups: 
##           school case %in% school 
##                3               12</code></pre>
<p>The estimated variance components from the fitted model can be obtained using <code><a href="../reference/extract_varcomp.html">extract_varcomp()</a></code>:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/extract_varcomp.html">extract_varcomp</a></span>(<span class="no">Bryant2016_RML</span>)</pre></body></html></div>
<pre><code>## $Tau
## $Tau$school
## school.var((Intercept)) 
##                  158.24 
## 
## $Tau$case
## case.var((Intercept)) 
##              255.4297 
## 
## 
## $cor_params
## numeric(0)
## 
## $var_params
## numeric(0)
## 
## $sigma_sq
## [1] 338.4864
## 
## attr(,"class")
## [1] "varcomp"</code></pre>
<p>In our model for the Bryant data, we use the treatment effect in the numerator of the effect size and the sum of the classroom-level, student-level, and within-student variance components in the denominator of the effect size. The constants are therefore given by <span class="math inline">\(\mathbf{p} = (0, 1)'\)</span> and <span class="math inline">\(\mathbf{r} = (1, 1, 1)'\)</span>. The effect size estimate can be calculated as:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">Bryant2016_g</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/g_mlm.html">g_mlm</a></span>(<span class="no">Bryant2016_RML</span>, <span class="kw">p_const</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1</span>), <span class="kw">r_const</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>), <span class="kw">infotype</span> <span class="kw">=</span> <span class="st">"expected"</span>)</pre></body></html></div>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">Bryant2016_g</span></pre></body></html></div>
<pre><code>##                           est    se
## unadjusted effect size  1.799 0.340
## adjusted effect size    1.721 0.325
## degree of freedom      17.504</code></pre>
<p>A <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method is also included, which includes more detail about the model parameter estimates and effect size estimate:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">Bryant2016_g</span>)</pre></body></html></div>
<pre><code>##                                            est      se
## Tau.school.school.var((Intercept))     158.240 238.653
## Tau.case.case.var((Intercept))         255.430 126.671
## sigma_sq                               338.486  28.306
## total variance                         752.156 254.250
## (Intercept)                             56.143   9.019
## treatmenttreatment                      49.335   2.399
## treatment effect at a specified time    49.335   2.399
## unadjusted effect size                   1.799   0.340
## adjusted effect size                     1.721   0.325
## degree of freedom                       17.504        
## constant kappa                           0.087        
## logLik                               -1308.786</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Bryant, B. R., Bryant, D. P., Porterfield, J., Dennis, M. S., Falcomata, T., Valentine, C., … &amp; Bell, K. (2016). The effects of a Tier 3 intervention on the mathematics performance of second grade students with severe mathematics difficulties. <em>Journal of Learning Disabilities, 49</em>(2), 176-188. <a href="doi:10.1177/0022219414538516" class="uri">doi:10.1177/0022219414538516</a></p>
<p>Pustejovsky, J. E., Hedges, L. V., &amp; Shadish, W. R. (2014). Design-comparable effect sizes in multiple baseline designs: A general modeling framework. <em>Journal of Educational and Behavioral Statistics, 39</em>(5), 368–393. <a href="doi:10.3102/1076998614547577" class="uri">doi:10.3102/1076998614547577</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.jepusto.com/">James Pustejovsky</a>, Man Chen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'ab49bdeb500af0e2e09f15c826d29f1f',
    indexName: 'lmeInfo',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
